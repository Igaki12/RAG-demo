# RAG Demo 編集ガイド

このリポジトリで作業するエージェント向けのメモです。編集は以下のポリシーを守って進めてください。

## バックアップと命名規則

- 各シリーズの最新版ファイル名は `*-latest.html` とします。
- 更新・保存時には必ず当日のバックアップを `*-YYYYMMDD.html`（例: `current-affairs-quest-20250309.html`）として作成します。
- 既存ファイルに手を加える際は、編集前の版をバックアップとして残したことを作業報告で明記してください。

## 作業フロー

1. 編集対象の最新版 (`*-latest.html`) を確認する。
2. 変更前の内容を日付付きバックアップに複製する。
3. バックアップ作成後に最新版を編集する。
4. 作業終了時に、どのバックアップを生成したかを報告する。

## 備考

- 既存の複数バージョンが存在する場合は、もっとも新しいものを最新版として扱い、そこから命名規則を適用してください。
- 新しい運用ルールが発生した場合は、このファイルに追記して全員で共有します。

## 現行Web UI仕様（HTML/CSS/JS）

- 対象ファイルは `commonsense-latest.html`、`current-affairs-quest-latest.html`、`index.html`（必要に応じてサブページ）です。更新前に必ず日付付きバックアップを作成してください。
- 利用者は JSONL ファイルをアップロードし、ニュース記事の共起ネットワーク図と理解度テストを体験します。
- 理解度テストは 3 択形式で、JSONL 内の `choices` 配列の先頭要素を正解として扱います。表示時はシャッフルし、正解選択時は旧「GOOD」挙動、不正解時は旧「BAD」挙動を踏襲してください。
- ランダム出題や記事詳細モーダルなど既存の UI/UX 挙動は維持しつつ、問題表示・フィードバック領域のみ新仕様に合わせてあります。編集時は既存アニメーション・アクセシビリティ属性を壊さないよう注意してください。

## データ仕様（JSONL）

- 基本構造は 1 行 1 レコードの JSON。主要キーは `date_id`（YYYYMMDD 文字列）、`headline`、`content`、`named_entities`、`questions` です。
- `questions` は配列で、各要素は最低限 `question`（文字列）と `choices`（文字列配列）を持ちます。`choices[0]` が正解であることが前提です。任意で `explanation` または `reasoning` を含められます。
- 共起ネットワーク計算は `named_entities` を前提に行います。エンティティは重複を避け、意味のある文字列のみを格納してください。
- 新旧フォーマットが混在する場合は、新フォーマット（`news_full_mcq3_type9_entities_novectors.jsonl` に準拠）が優先です。旧フォーマットを扱うページを改修する際は、正解が単一文字列で提供されるケースへのフォールバックを検討してください。

## 対象ユーザーと目的

- 利用者は学生および新社会人を想定しています。ニュース理解力・社会常識力の測定および底上げがゴールです。
- 出題やネットワーク図は、タイムリーなニュースに対する背景理解を促すよう構成してください。説明文、フィードバック文言は過度に専門的にならないよう保ちます。

## React デモアプリ開発方針（次フェーズ）

- 既存の HTML ベース実装と同等の機能（JSONL アップロード、ネットワーク可視化、3 択理解度テスト）を React コンポーネントとして再構築します。
- アカウント機能を実装し、ログイン / ログアウト状態に連動した UI 制御を行います。認証バックエンドの有無が未確定な場合はダミー実装で進め、要件が固まり次第差し替えます。
- ユーザー単位で正答率を記録し、問題カテゴリ別や時系列の成績を確認できるようにします。将来的な難易度調整（適応型出題）のため、問題メタデータと正答履歴を保存できる API インターフェースを検討してください。
- CBT（Computer Based Testing）スタイルで常時受験可能にし、受験直後に全体順位（例：上位◯パーセント）を提示できるランキング機能を目指します。集計仕様・データ保持期間について不明点があれば事前に確認を取ってください。
- React 版でも JSONL アップロードを基本としますが、将来的な API 連携を考慮し、ファイル取り扱いロジックを専用サービス層に切り出しておくとスムーズです。
- 上記仕様のうち未確定項目（例：認証方式、成績データの保存場所、ランキング算出の詳細など）がある場合は、実装前に必ずオーナーへ確認してください。
